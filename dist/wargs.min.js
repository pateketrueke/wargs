!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):(e=e||self).wargs=r()}(this,(function(){"use strict";const e=/$|[!-@\[-`{-~].*/g,r=[];function t(e,r,t,n,i){var o=e[r],a=n[r],f=void 0!==a;if((f||void 0===i||!1!==i(r))&&(void 0===o?e[r]=t:Array.isArray(o)?o.push(t):e[r]=[o,t],f))for(var s=0,c=a.length;s<c;)e[a[s++]]=e[r]}var n=function(n,i){for(var o=(i=i||{}).unknown,a=function(e){var r,t={};for(var n in e)for(var i=t[n]=(r=e[n],Array.isArray(r)?r:[r]),o=0,a=i.length;o<a;o++)for(var f=t[i[o]]=[n],s=0;s<a;s++)o!==s&&f.push(i[s]);return t}(i.alias),f=function(e,t){var n={};for(var i in t){var o=t[i],a=e[i];if(void 0===n[i])if(n[i]=o,void 0===a)e[i]=r;else for(var f=0,s=a.length;f<s;f++)n[a[f]]=o}return n}(a,i.default),s=function(e,t){var n={};if(void 0!==t)for(var i=0,o=t.length;i<o;i++){var a=t[i],f=e[a];if(n[a]=!0,void 0===f)e[a]=r;else for(var s=0,c=f.length;s<c;s++)n[f[s]]=!0}return n}(a,i.boolean),c={_:[]},l=0,u=0,d=n.length,p=c._;l<d;l++){var v=n[l];if("--"===v)for(;++l<d;)p.push(n[l]);else if("-"===v||"-"!==v[0])p.push(v);else if("-"===v[1]){if(0<=(y=v.indexOf("=",2)))t(c,v.slice(2,y),v.slice(y+1),a,o);else if("n"===v[2]&&"o"===v[3]&&"-"===v[4])t(c,v.slice(5),!1,a,o);else t(c,m=v.slice(2),d===(u=l+1)||"-"===n[u][0]||void 0!==s[m]||n[l=u],a,o)}else{e.lastIndex=2;var h=e.exec(v),y=h.index,g=h[0]||d===(u=l+1)||"-"===n[u][0]||void 0!==s[v[y-1]]||n[l=u];for(u=1;u<y;)t(c,v[u],++u!==y||g,a,o)}}for(var m in f)void 0===c[m]&&(c[m]=f[m]);return c};const i=e=>`__Symbol@@${e}__`,o=i("QUOTE"),a=i("APOS"),f=i("SPA"),s=/-(\w)/g,c=/^((?!\d)[-~+.\w]+)([=:])(.+?)?$/,l=/(["'])(?:(?!\1).)*\1/,u=['"',"'"," "],d=[/\\"/g,/\\'/g,/\\ /g],p=[o,a,f],v=[o,a,f].map(e=>new RegExp(e,"g"));function h(e){return v.reduce((e,r,t)=>e.replace(r,u[t]),e)}function y(e,r){for(;l.test(e);){const r=e.match(l),t=r[0].substr(1,r[0].length-2);e=e.replace(r[0],u.reduce((e,r,t)=>e.replace(r,p[t]),t))}if(r)for(;e.indexOf(" ")>-1;)e=u.reduce((e,r,t)=>e.replace(r,p[t]),e);return e.split(/\s+/)}function g(e,r){if("function"==typeof r){if("object"!=typeof e)return r(e);Object.keys(e).forEach(t=>{e[t]=r(e[t],t)})}return e}return(e,r,t)=>{if("function"==typeof(r=r||{})&&(t=r,r={}),r.format&&(t=r.format,delete r.format),!Array.isArray(e)){let r;e=function(e){return d.reduce((e,r,t)=>e.replace(r,p[t]),e)}(String(e||""));do{(r=e.match(l))&&(e=e.replace(r[0],y(r[0],!0)))}while(r);e=e.trim().split(/\s+/).map(h).filter(e=>e)}const i=e.indexOf("--"),o=[];i>-1&&(e.slice(i+1).forEach(e=>{o.push(g(e,t))}),e.splice(i+1,e.length));const a=n(e,r),f=a._.slice(),u={},v={};return delete a._,Object.keys(a).forEach(e=>{const n=a[e];-1!==e.indexOf("-")&&(delete a[e],e=function(e){return e.replace(s,(e,r)=>r.toUpperCase())}(e)),r.alias&&r.alias[e]&&0===r.alias[e].indexOf("no-")&&(a[r.alias[e].substr(3)]=!n,a[e]=!n),Array.isArray(n)&&(a[e]=n.map(e=>g(e,t))),"string"==typeof n&&("="===n.charAt()?a[e]=g(n.substr(1),t):a[e]=g(n,t))}),{_:f.reduce((e,r)=>{const n=r.match(c);return n?"="===n[2]?u[n[1]]=g(n[3]||"",t):v[n[1]]?(Array.isArray(v[n[1]])||(v[n[1]]=[v[n[1]]]),v[n[1]].push(g(n[3]||"",t))):v[n[1]]=g(n[3]||"",t):e.push(g(r,t)),e},[]),raw:o,data:u,flags:a,params:v}}}));
